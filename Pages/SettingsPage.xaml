<Page
    x:Class="DoomLauncher.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:DoomLauncher"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    mc:Ignorable="d"
>
    <Grid RowDefinitions="48,*">
        <TextBlock
            Grid.Row="0"
            VerticalAlignment="Center"
            Margin="16,0"
            Text="Настройки"
            FontSize="18"
            Style="{ThemeResource BaseTextBlockStyle}"
        />
        <ScrollView
            Grid.Row="1"
        >
            <StackPanel Margin="16,0,16,16">
                <TextBlock
                    Text="Установленные GZDoom"
                    Margin="0,0,0,4"
                    Style="{ThemeResource BaseTextBlockStyle}"
                />
                <ListView
                    ItemsSource="{x:Bind settings.GZDoomInstalls, Mode=OneWay}"
                    HorizontalAlignment="Stretch"
                    SelectionMode="None"
                    Margin="-8,0"
                    CanReorderItems="True"
                    AllowDrop="True"
                >
                    <ListView.ItemTemplate>
                        <DataTemplate x:DataType="local:GZDoomPackage">
                            <Grid ColumnDefinitions="*,Auto,Auto">
                                <TextBlock
                                    Text="{x:Bind local:SettingsPage.GZDoomPackageToTitle(Version, Arch), Mode=OneWay}"
                                    VerticalAlignment="Center"
                                />
                                <Button
                                    Grid.Column="1"
                                    VerticalAlignment="Center"
                                    Click="OpenContainFolder_Click"
                                    Style="{ThemeResource EllipsisButton}"
                                    Height="40"
                                    Width="40"
                                    ToolTipService.ToolTip="Открыть расположение"
                                >
                                    <FontIcon Glyph="&#xE838;" FontSize="16" />
                                </Button>
                                <Button
                                    Grid.Column="2"
                                    VerticalAlignment="Center"
                                    Click="RemovePackage_Click"
                                    Style="{ThemeResource EllipsisButton}"
                                    Height="40"
                                    Width="40"
                                    ToolTipService.ToolTip="Удалить ссылку"
                                >
                                    <FontIcon Glyph="&#xE74D;" FontSize="16" />
                                </Button>
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
                <controls:WrapPanel Orientation="Horizontal" Margin="0,8,0,0" HorizontalSpacing="4" VerticalSpacing="4">
                    <Button Click="BrowseButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <FontIcon Glyph="&#xEC50;" Margin="0,0,4,0" FontSize="16"/>
                            <TextBlock Text="Выбрать на устройстве" />
                        </StackPanel>
                    </Button>
                    <Button Click="SearchPackages_Click">
                        <StackPanel Orientation="Horizontal">
                            <FontIcon Glyph="&#xE896;" Margin="0,0,4,0" FontSize="16"/>
                            <TextBlock Text="Загрузить из интернета" />
                        </StackPanel>
                    </Button>
                </controls:WrapPanel>
                <TextBlock
                    Text="Установленные iWad"
                    Margin="0,16,0,4"
                    Style="{ThemeResource BaseTextBlockStyle}"
                />
                <ListView
                    ItemsSource="{x:Bind settings.IWadFiles, Mode=OneWay}"
                    HorizontalAlignment="Stretch"
                    Margin="-8,0"
                    CanReorderItems="True"
                    AllowDrop="True"
                    SelectionMode="None"
                >
                    <ListView.ItemTemplate>
                        <DataTemplate x:DataType="x:String">
                            <Grid ColumnDefinitions="*,Auto,Auto">
                                <TextBlock
                                    Text="{x:Bind local:SettingsPage.IWadFileToTitle((x:String))}"
                                    VerticalAlignment="Center"
                                />
                                <Button
                                    Grid.Column="1"
                                    VerticalAlignment="Center"
                                    Click="OpenIWadFolder_Click"
                                    Style="{ThemeResource EllipsisButton}"
                                    Height="40"
                                    Width="40"
                                    ToolTipService.ToolTip="Открыть расположение файла"
                                >
                                    <FontIcon Glyph="&#xE838;" FontSize="16" />
                                </Button>
                                <Button
                                    Grid.Column="2"
                                    VerticalAlignment="Center"
                                    Click="RemoveIWad_Click"
                                    Style="{ThemeResource EllipsisButton}"
                                    Height="40"
                                    Width="40"
                                    ToolTipService.ToolTip="Удалить ссылку на файл"
                                >
                                    <FontIcon Glyph="&#xE74D;" FontSize="16" />
                                </Button>
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
                <Button Margin="0,8,0,0" Click="BrowseIWadButton_Click">
                    <StackPanel Orientation="Horizontal">
                        <FontIcon Glyph="&#xEC50;" Margin="0,0,4,0" FontSize="16"/>
                        <TextBlock Text="Выбрать на устройстве" />
                    </StackPanel>
                </Button>
                <TextBlock
                    Text="Дополнительно"
                    Margin="0,16,0,4"
                    Style="{ThemeResource BaseTextBlockStyle}"
                />
                <CheckBox
                    Content="Закрывать лаунчер при запуске сборки"
                    IsChecked="{x:Bind settings.CloseOnLaunch, Mode=TwoWay}"
                />
                <TextBlock Text="О приложении" Margin="0,16,0,4" Style="{ThemeResource BodyStrongTextBlockStyle}"/>
                <TextBlock Text="GZDoom Launcher" />
                <TextBlock Text="{x:Bind appVersion}" />
            </StackPanel>
        </ScrollView>
    </Grid>
</Page>
